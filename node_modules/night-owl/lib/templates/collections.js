const has = (val) => val || val === 0

export const sortPages = (a, b) => {
  if (a.data.sort !== b.data.sort) {
    if (has(a.data.sort) && !has(b.data.sort)) return -1
    if (has(b.data.sort) && !has(a.data.sort)) return 1
    if (has(a.data.sort) && has(b.data.sort))
      return a.data.sort > b.data.sort ? 1 : -1
  }

  if (a.data.date !== b.data.date) {
    if (has(a.data.date) && !has(b.data.date)) return -1
    if (has(b.data.date) && !has(a.data.date)) return 1
    if (has(a.data.date) && has(b.data.date))
      return a.data.date < b.data.date ? 1 : -1
  }

  return a.meta.src.localeCompare(b.meta.src)
}

const base = ["all"]

export const append = (page, collections) => {
  const tags = page.data.tags ? base.concat(page.data.tags) : base

  tags.forEach((tag) => {
    if (!collections[tag]) collections[tag] = [page]
    else collections[tag].push(page)
  })
}
